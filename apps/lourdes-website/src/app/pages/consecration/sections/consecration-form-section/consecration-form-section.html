<!-- Consecration Form Section -->
<section class="py-16 px-2 bg-gray-50 relative overflow-hidden">
  <div class="max-w-3xl mx-auto relative z-10">
    <div class="text-center mb-12">
      <h2 class="text-4xl font-bold text-gray-800 mb-4">
        Consecration Inquiry Form
      </h2>
      <div class="h-1 w-20 bg-amber-600 mx-auto mb-4"></div>
      <p class="text-lg text-gray-700">
        Fill out the form below to learn more about the path to ordination.
      </p>
    </div>

    <div class="bg-white rounded-2xl shadow-xl p-8">
      <!-- Stepper -->
      <ul class="steps steps-horizontal w-full mb-8">
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 1 }">
          Personal Info
        </li>
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 2 }">
          Privacy
        </li>
      </ul>

      <form [formGroup]="consecrationForm" (ngSubmit)="onSubmit()">
        <!-- Step 1: Personal Information -->
        @if(currentStep === 1) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">
            Personal Information
          </h3>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Name <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="name"
              placeholder="Enter your name"
              class="input input-bordered w-full"
              [class.input-error]="
                consecrationForm.get('name')?.invalid &&
                consecrationForm.get('name')?.touched
              "
            />
            @if(consecrationForm.get('name')?.invalid &&
            consecrationForm.get('name')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error">Name is required</span>
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Last name <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="lastName"
              placeholder="Enter your last name"
              class="input input-bordered w-full"
              [class.input-error]="
                consecrationForm.get('lastName')?.invalid &&
                consecrationForm.get('lastName')?.touched
              "
            />
            @if(consecrationForm.get('lastName')?.invalid &&
            consecrationForm.get('lastName')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Last name is required</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Mobile phone <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="tel"
              formControlName="mobilePhone"
              placeholder="+31 6 1234 5678"
              class="input input-bordered w-full"
              [class.input-error]="
                consecrationForm.get('mobilePhone')?.invalid &&
                consecrationForm.get('mobilePhone')?.touched
              "
            />
            @if(consecrationForm.get('mobilePhone')?.invalid &&
            consecrationForm.get('mobilePhone')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Mobile phone is required</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Email address <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="email"
              formControlName="emailAddress"
              placeholder="your.email@example.com"
              class="input input-bordered w-full"
              [class.input-error]="
                consecrationForm.get('emailAddress')?.invalid &&
                consecrationForm.get('emailAddress')?.touched
              "
            />
            @if(consecrationForm.get('emailAddress')?.invalid &&
            consecrationForm.get('emailAddress')?.touched) {
            <label class="label">
              @if(consecrationForm.get('emailAddress')?.hasError('required')) {
              <span class="label-text-alt text-error">
                Email address is required
              </span>
              } @else if(consecrationForm.get('emailAddress')?.hasError('email')) {
              <span class="label-text-alt text-error">
                Please enter a valid email address
              </span>
              }
            </label>
            }
          </div>
        </div>
        }

        <!-- Step 2: Privacy Statement -->
        @if(currentStep === 2) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">
            Privacy Statement
          </h3>

          <div class="bg-amber-50 p-6 rounded-lg">
            <h4 class="font-bold text-lg text-gray-800 mb-3">
              Privacy Statement Roman Catholic Parishes and General Regulations
              for the Protection of Personal Data Parishes 2018
            </h4>
            <p class="text-sm text-gray-700 mb-3">
              In connection with the General Data Protection Regulation (GDPR),
              a Privacy Statement applies and the above-mentioned regulations
              have been drawn up. The Privacy Statement and the General
              Regulations are available on the website and can be downloaded.
            </p>
            <p class="text-sm text-gray-700 mb-3">
              You will automatically receive the Privacy Statement as an
              attachment with the copy confirmation.
            </p>
            <p class="text-sm text-gray-700 mb-3">
              Below you will find a number of matters (in abbreviated,
              simplified versions) that are important to you and for which we
              request your permission (in advance). If you have any doubts about
              the explanation in the abbreviated version, we always refer you to
              the full Privacy Statement and/or the General Regulations.
            </p>
            <p class="text-sm text-gray-700 mb-3 font-semibold">
              Information General
            </p>
            <div class="mt-4 space-y-3">
              <div>
                <p class="font-semibold text-gray-800">Agreement</p>
                <p class="text-sm text-gray-700">
                  The applicant(s) agree(s) to the provisions of the Privacy
                  Statement.
                </p>
              </div>
              <div>
                <p class="font-semibold text-gray-800">Disagreement</p>
                <p class="text-sm text-gray-700">
                  If you do not agree, the application cannot be processed.
                </p>
              </div>
              <p class="text-sm text-gray-700">
                The information you provide may be used for parish
                administration and will be stored digitally or on paper (in
                registers) for this purpose. A request to view this data is
                possible. Requesting the deletion of this data is generally not
                possible because it is necessary for the proper functioning of a
                parish church. The "Registration and Deregistration Procedure
                (2013)" applies to requests to be removed from the parish
                registers/administration.
              </p>
              <p class="text-sm text-gray-700">
                Your information will always be treated confidentially and will
                never be shared with external institutions/agencies/third
                parties without your permission. At the end of this form, you
                will be asked a few questions regarding the GDPR. You can agree
                or disagree with the questions posed there, and your request
                will be processed (regardless of your answer).
              </p>
            </div>
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Do you agree with our parish's privacy policy?
                <span class="text-red-600">*</span></span
              >
            </label>
            <div class="space-y-3">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="privacyAgreement"
                  value="agree"
                  class="radio radio-warning"
                />
                <span class="label-text">Yes! I agree</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="privacyAgreement"
                  value="disagree"
                  class="radio radio-warning"
                />
                <span class="label-text">No! I don't agree</span>
              </label>
            </div>
            @if(consecrationForm.get('privacyAgreement')?.invalid &&
            consecrationForm.get('privacyAgreement')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Please agree to privacy policy to continue</span
              >
            </label>
            }
          </div>
        </div>
        }

        <!-- Success Message -->
        @if(submitSuccess) {
        <div class="alert alert-success mb-6">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="stroke-current shrink-0 h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <span
            >Thank you for your inquiry! We will contact you soon to explore
            together how your vocation can grow.</span
          >
        </div>
        }

        <!-- Error Message -->
        @if(submitError) {
        <div class="alert alert-error mb-6">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="stroke-current shrink-0 h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <span
            >There was an error submitting your request. Please try again.</span
          >
        </div>
        }

        <!-- Navigation Buttons -->
        <div class="flex justify-between mt-8">
          @if(currentStep > 1) {
          <button
            type="button"
            class="btn btn-outline btn-warning"
            (click)="previousStep()"
          >
            Previous
          </button>
          } @else {
          <div></div>
          } @if(currentStep < 2) {
          <button
            type="button"
            class="btn bg-amber-600 hover:bg-amber-700 text-white border-none"
            (click)="nextStep()"
          >
            Next
          </button>
          } @else {
          <button
            type="submit"
            class="btn bg-amber-600 hover:bg-amber-700 text-white border-none"
            [disabled]="consecrationForm.invalid || isSubmitting"
          >
            @if(isSubmitting) {
            <span class="loading loading-spinner"></span>
            Submitting... } @else { Submit Inquiry }
          </button>
          }
        </div>
      </form>
    </div>
  </div>
</section>
