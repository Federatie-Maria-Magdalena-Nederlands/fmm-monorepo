<!-- Holy Communion Form Section -->
<section class="py-16 px-2 bg-gray-50 relative overflow-hidden">
  <app-abstract-background></app-abstract-background>

  <div class="max-w-3xl mx-auto relative z-10">
    <div class="text-center mb-12">
      <h2 class="text-4xl font-bold text-gray-800 mb-4">
        Eerste Heilige Communie Registratieformulier
      </h2>
      <div class="h-1 w-20 bg-amber-600 mx-auto mb-4"></div>
      <p class="text-lg text-gray-700">
        Vul het onderstaande formulier in om uw kind aan te melden voor de Eerste Heilige Communie.
      </p>
    </div>

    <div class="bg-white rounded-2xl shadow-xl p-8">
      <!-- Stepper -->
      <ul class="steps steps-horizontal w-full mb-8">
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 1 }">
          Communicant
        </li>
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 2 }">
          Moeder
        </li>
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 3 }">
          Vader
        </li>
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 4 }">
          Doopgetuigen
        </li>
        <li class="step" [ngClass]="{ 'step-warning': currentStep >= 5 }">
          Privacy
        </li>
      </ul>

      <form [formGroup]="communionForm" (ngSubmit)="onSubmit()">
        <!-- Step 1: Communicant Information -->
        @if(currentStep === 1) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">Afzender</h3>

          <!-- Name -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Naam communicant <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="communicantName"
              placeholder="Voer naam in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantName')?.invalid &&
                communionForm.get('communicantName')?.touched
              "
            />
            @if(communionForm.get('communicantName')?.invalid &&
            communionForm.get('communicantName')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error">Naam is verplicht</span>
            </label>
            }
          </div>

          <!-- Surname -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Achternaam communicant <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="communicantSurname"
              placeholder="Voer achternaam in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantSurname')?.invalid &&
                communionForm.get('communicantSurname')?.touched
              "
            />
            @if(communionForm.get('communicantSurname')?.invalid &&
            communionForm.get('communicantSurname')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error">Achternaam is verplicht</span>
            </label>
            }
          </div>

          <!-- First Name -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Voornaam communicant
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="communicantFirstName"
              placeholder="Voer voornaam in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantFirstName')?.invalid &&
                communionForm.get('communicantFirstName')?.touched
              "
            />
            @if(communionForm.get('communicantFirstName')?.invalid &&
            communionForm.get('communicantFirstName')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Voornaam is verplicht</span
              >
            </label>
            }
          </div>

          <!-- Date and Place of Birth -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geboortedatum en geboorteplaats
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="communicantDOB"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantDOB')?.invalid &&
                communionForm.get('communicantDOB')?.touched
              "
            />
            @if(communionForm.get('communicantDOB')?.invalid &&
            communionForm.get('communicantDOB')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Geboortedatum is verplicht</span
              >
            </label>
            }
          </div>

          <!-- Gender -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geslacht <span class="text-red-600">*</span></span
              >
            </label>
            <div class="flex gap-6">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="communicantGender"
                  value="Boy"
                  class="radio radio-warning"
                />
                <span class="label-text">Jongen</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="communicantGender"
                  value="Girl"
                  class="radio radio-warning"
                />
                <span class="label-text">Meisje</span>
              </label>
            </div>
            @if(communionForm.get('communicantGender')?.invalid &&
            communionForm.get('communicantGender')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Selecteer geslacht</span
              >
            </label>
            }
          </div>

          <!-- Nationality -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Nationaliteit communicant
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="communicantNationality"
              placeholder="Voer nationaliteit in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantNationality')?.invalid &&
                communionForm.get('communicantNationality')?.touched
              "
            />
            @if(communionForm.get('communicantNationality')?.invalid &&
            communionForm.get('communicantNationality')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Nationaliteit is verplicht</span
              >
            </label>
            }
          </div>

          <!-- Baptized -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Gedoopt? <span class="text-red-600">*</span></span
              >
            </label>
            <div class="flex gap-6">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="communicantBaptized"
                  value="Yes"
                  class="radio radio-warning"
                />
                <span class="label-text">Ja</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="communicantBaptized"
                  value="No"
                  class="radio radio-warning"
                />
                <span class="label-text">Nee</span>
              </label>
            </div>
            @if(communionForm.get('communicantBaptized')?.invalid &&
            communionForm.get('communicantBaptized')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Selecteer een optie</span
              >
            </label>
            }
          </div>

          <!-- Conditional fields when baptized -->
          @if(communionForm.get('communicantBaptized')?.value === 'Yes') {
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Indien ja, vermeld de datum
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="communicantBaptismDate"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantBaptismDate')?.invalid &&
                communionForm.get('communicantBaptismDate')?.touched
              "
            />
            @if(communionForm.get('communicantBaptismDate')?.invalid &&
            communionForm.get('communicantBaptismDate')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Doopdatum is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Doopakte <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="file"
              (change)="onFileSelected($event, 'communicant')"
              accept="image/*,.pdf"
              class="file-input file-input-bordered file-input-warning w-full"
            />
            @if(selectedCommunicantCertificate) {
            <label class="label">
              <span class="label-text-alt text-success"
                >Geselecteerd: {{ selectedCommunicantCertificate }}</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Doopplaats <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="communicantBaptismPlace"
              placeholder="Voer doopplaats in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('communicantBaptismPlace')?.invalid &&
                communionForm.get('communicantBaptismPlace')?.touched
              "
            />
            @if(communionForm.get('communicantBaptismPlace')?.invalid &&
            communionForm.get('communicantBaptismPlace')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Doopplaats is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Naam van de parochie waar communicant gedoopt werd
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              placeholder="Voer parochienaam in"
              class="input input-bordered w-full"
            />
          </div>
          }
        </div>
        }

        <!-- Step 2: Mother's Information -->
        @if(currentStep === 2) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">
            Informatie Moeder
          </h3>

          <!-- Mother's surname is shown on the image but not in a required field list. 
               I'll include it for completeness based on the pattern -->
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Achternaam moeder <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              placeholder="Voer achternaam moeder in"
              class="input input-bordered w-full"
            />
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Voornamen moeder <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="motherFirstNames"
              placeholder="Voer voornamen moeder in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherFirstNames')?.invalid &&
                communionForm.get('motherFirstNames')?.touched
              "
            />
            @if(communionForm.get('motherFirstNames')?.invalid &&
            communionForm.get('motherFirstNames')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Voornamen moeder zijn verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geboortedatum moeder
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="motherDOB"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherDOB')?.invalid &&
                communionForm.get('motherDOB')?.touched
              "
            />
            @if(communionForm.get('motherDOB')?.invalid &&
            communionForm.get('motherDOB')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Geboortedatum moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geboorteplaats moeder
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="motherPlaceOfBirth"
              placeholder="Voer geboorteplaats in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherPlaceOfBirth')?.invalid &&
                communionForm.get('motherPlaceOfBirth')?.touched
              "
            />
            @if(communionForm.get('motherPlaceOfBirth')?.invalid &&
            communionForm.get('motherPlaceOfBirth')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Geboorteplaats moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Moeder gedoopt? <span class="text-red-600">*</span></span
              >
            </label>
            <div class="flex gap-6">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="motherBaptized"
                  value="Yes"
                  class="radio radio-warning"
                />
                <span class="label-text">Ja</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="motherBaptized"
                  value="No"
                  class="radio radio-warning"
                />
                <span class="label-text">Nee</span>
              </label>
            </div>
            @if(communionForm.get('motherBaptized')?.invalid &&
            communionForm.get('motherBaptized')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Selecteer een optie</span
              >
            </label>
            }
          </div>

          @if(communionForm.get('motherBaptized')?.value === 'Yes') {
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Doopdatum moeder <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="motherBaptismDate"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherBaptismDate')?.invalid &&
                communionForm.get('motherBaptismDate')?.touched
              "
            />
            @if(communionForm.get('motherBaptismDate')?.invalid &&
            communionForm.get('motherBaptismDate')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Doopdatum moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Doopplaats moeder
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="motherBaptismPlace"
              placeholder="Voer doopplaats in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherBaptismPlace')?.invalid &&
                communionForm.get('motherBaptismPlace')?.touched
              "
            />
            @if(communionForm.get('motherBaptismPlace')?.invalid &&
            communionForm.get('motherBaptismPlace')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Doopplaats moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Doopakte moeder</span
              >
            </label>
            <input
              type="file"
              (change)="onFileSelected($event, 'mother')"
              accept="image/*,.pdf"
              class="file-input file-input-bordered file-input-warning w-full"
            />
            @if(selectedMotherCertificate) {
            <label class="label">
              <span class="label-text-alt text-success"
                >Geselecteerd: {{ selectedMotherCertificate }}</span
              >
            </label>
            }
          </div>
          }

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Nationaliteit moeder <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="motherNationality"
              placeholder="Voer nationaliteit in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherNationality')?.invalid &&
                communionForm.get('motherNationality')?.touched
              "
            />
            @if(communionForm.get('motherNationality')?.invalid &&
            communionForm.get('motherNationality')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Nationaliteit moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Adres moeder <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="motherAddress"
              placeholder="Straatnaam en huisnummer"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherAddress')?.invalid &&
                communionForm.get('motherAddress')?.touched
              "
            />
            @if(communionForm.get('motherAddress')?.invalid &&
            communionForm.get('motherAddress')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Adres moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Postcode en woonplaats moeder
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="motherPostalCity"
              placeholder="Postcode en plaats"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherPostalCity')?.invalid &&
                communionForm.get('motherPostalCity')?.touched
              "
            />
            @if(communionForm.get('motherPostalCity')?.invalid &&
            communionForm.get('motherPostalCity')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Postcode en plaats zijn verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Mobiele telefoon moeder <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="tel"
              formControlName="motherPhone"
              placeholder="+31 6 1234 5678"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherPhone')?.invalid &&
                communionForm.get('motherPhone')?.touched
              "
            />
            @if(communionForm.get('motherPhone')?.invalid &&
            communionForm.get('motherPhone')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Telefoonnummer moeder is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >E-mailadres moeder
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="email"
              formControlName="motherEmail"
              placeholder="moeder.email@voorbeeld.com"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('motherEmail')?.invalid &&
                communionForm.get('motherEmail')?.touched
              "
            />
            @if(communionForm.get('motherEmail')?.invalid &&
            communionForm.get('motherEmail')?.touched) {
            <label class="label">
              @if(communionForm.get('motherEmail')?.hasError('required')) {
              <span class="label-text-alt text-error">
                E-mailadres moeder is verplicht
              </span>
              } @else if(communionForm.get('motherEmail')?.hasError('email')) {
              <span class="label-text-alt text-error">
                Voer een geldig e-mailadres in
              </span>
              }
            </label>
            }
          </div>
        </div>
        }

        <!-- Step 3: Father's Information -->
        @if(currentStep === 3) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">
            Informatie Vader
          </h3>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Achternaam vader <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="fatherSurname"
              placeholder="Voer achternaam vader in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherSurname')?.invalid &&
                communionForm.get('fatherSurname')?.touched
              "
            />
            @if(communionForm.get('fatherSurname')?.invalid &&
            communionForm.get('fatherSurname')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Achternaam vader is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Voornamen vader <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="fatherFirstNames"
              placeholder="Voer voornamen vader in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherFirstNames')?.invalid &&
                communionForm.get('fatherFirstNames')?.touched
              "
            />
            @if(communionForm.get('fatherFirstNames')?.invalid &&
            communionForm.get('fatherFirstNames')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Voornamen vader zijn verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geboortedatum vader
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="fatherDOB"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherDOB')?.invalid &&
                communionForm.get('fatherDOB')?.touched
              "
            />
            @if(communionForm.get('fatherDOB')?.invalid &&
            communionForm.get('fatherDOB')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Geboortedatum vader is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geboorteplaats vader
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="fatherPlaceOfBirth"
              placeholder="Voer geboorteplaats in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherPlaceOfBirth')?.invalid &&
                communionForm.get('fatherPlaceOfBirth')?.touched
              "
            />
            @if(communionForm.get('fatherPlaceOfBirth')?.invalid &&
            communionForm.get('fatherPlaceOfBirth')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Geboorteplaats vader is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Vader gedoopt?</span
              >
            </label>
            <div class="flex gap-6">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="fatherBaptized"
                  value="Yes"
                  class="radio radio-warning"
                />
                <span class="label-text">Ja</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="fatherBaptized"
                  value="No"
                  class="radio radio-warning"
                />
                <span class="label-text">Nee</span>
              </label>
            </div>
            @if(communionForm.get('fatherBaptized')?.invalid &&
            communionForm.get('fatherBaptized')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Selecteer een optie</span
              >
            </label>
            }
          </div>

          @if(communionForm.get('fatherBaptized')?.value === 'Yes') {
          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Doopdatum vader <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="fatherBaptismDate"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherBaptismDate')?.invalid &&
                communionForm.get('fatherBaptismDate')?.touched
              "
            />
            @if(communionForm.get('fatherBaptismDate')?.invalid &&
            communionForm.get('fatherBaptismDate')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Doopdatum vader is verplicht</span
              >
            </label>
            }
          </div>
          }

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Nationaliteit vader <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="fatherNationality"
              placeholder="Voer nationaliteit in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherNationality')?.invalid &&
                communionForm.get('fatherNationality')?.touched
              "
            />
            @if(communionForm.get('fatherNationality')?.invalid &&
            communionForm.get('fatherNationality')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Nationaliteit vader is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Adres vader <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="fatherAddress"
              placeholder="Straatnaam en huisnummer"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherAddress')?.invalid &&
                communionForm.get('fatherAddress')?.touched
              "
            />
            @if(communionForm.get('fatherAddress')?.invalid &&
            communionForm.get('fatherAddress')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Adres vader is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Postcode en woonplaats vader
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="fatherPostalCity"
              placeholder="Postcode en plaats"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherPostalCity')?.invalid &&
                communionForm.get('fatherPostalCity')?.touched
              "
            />
            @if(communionForm.get('fatherPostalCity')?.invalid &&
            communionForm.get('fatherPostalCity')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Postcode en plaats zijn verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Mobiele telefoon vader <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="tel"
              formControlName="fatherPhone"
              placeholder="+31 6 1234 5678"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherPhone')?.invalid &&
                communionForm.get('fatherPhone')?.touched
              "
            />
            @if(communionForm.get('fatherPhone')?.invalid &&
            communionForm.get('fatherPhone')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Telefoonnummer vader is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >E-mailadres vader
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="email"
              formControlName="fatherEmail"
              placeholder="vader.email@voorbeeld.com"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('fatherEmail')?.invalid &&
                communionForm.get('fatherEmail')?.touched
              "
            />
            @if(communionForm.get('fatherEmail')?.invalid &&
            communionForm.get('fatherEmail')?.touched) {
            <label class="label">
              @if(communionForm.get('fatherEmail')?.hasError('required')) {
              <span class="label-text-alt text-error">
                E-mailadres vader is verplicht
              </span>
              } @else if(communionForm.get('fatherEmail')?.hasError('email')) {
              <span class="label-text-alt text-error">
                Voer een geldig e-mailadres in
              </span>

              }
            </label>
            }
          </div>
        </div>
        }

        <!-- Step 4: Godparents Information -->
        @if(currentStep === 4) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">
            Informatie Doopgetuigen
          </h3>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Naam doopgetuige <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="godparentsName"
              placeholder="Voer naam doopgetuige in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('godparentsName')?.invalid &&
                communionForm.get('godparentsName')?.touched
              "
            />
            @if(communionForm.get('godparentsName')?.invalid &&
            communionForm.get('godparentsName')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Naam doopgetuige is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Achternaam doopgetuige <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="godparentsSurname"
              placeholder="Voer achternaam doopgetuige in"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('godparentsSurname')?.invalid &&
                communionForm.get('godparentsSurname')?.touched
              "
            />
            @if(communionForm.get('godparentsSurname')?.invalid &&
            communionForm.get('godparentsSurname')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Achternaam doopgetuige is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Geboortedatum doopgetuige
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="date"
              formControlName="godparentsDOB"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('godparentsDOB')?.invalid &&
                communionForm.get('godparentsDOB')?.touched
              "
            />
            @if(communionForm.get('godparentsDOB')?.invalid &&
            communionForm.get('godparentsDOB')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Geboortedatum doopgetuige is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Telefoonnummer doopgetuige
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="tel"
              formControlName="godparentsPhone"
              placeholder="+31 6 1234 5678"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('godparentsPhone')?.invalid &&
                communionForm.get('godparentsPhone')?.touched
              "
            />
            @if(communionForm.get('godparentsPhone')?.invalid &&
            communionForm.get('godparentsPhone')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Telefoonnummer doopgetuige is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Adres doopgetuige <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="godparentsAddress"
              placeholder="Straatnaam en huisnummer"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('godparentsAddress')?.invalid &&
                communionForm.get('godparentsAddress')?.touched
              "
            />
            @if(communionForm.get('godparentsAddress')?.invalid &&
            communionForm.get('godparentsAddress')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Adres doopgetuige is verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Postcode en woonplaats doopgetuige
                <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="godparentsPostalCity"
              placeholder="Postcode en plaats"
              class="input input-bordered w-full"
              [class.input-error]="
                communionForm.get('godparentsPostalCity')?.invalid &&
                communionForm.get('godparentsPostalCity')?.touched
              "
            />
            @if(communionForm.get('godparentsPostalCity')?.invalid &&
            communionForm.get('godparentsPostalCity')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Postcode en plaats zijn verplicht</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Zijn zijn doopgetuigen katholiek?
                <span class="text-red-600">*</span></span
              >
            </label>
            <div class="flex gap-6">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="godparentsCatholic"
                  value="Yes"
                  class="radio radio-warning"
                />
                <span class="label-text">Ja</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="godparentsCatholic"
                  value="No"
                  class="radio radio-warning"
                />
                <span class="label-text">Nee</span>
              </label>
            </div>
            @if(communionForm.get('godparentsCatholic')?.invalid &&
            communionForm.get('godparentsCatholic')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Selecteer een optie</span
              >
            </label>
            }
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Upload hier doopakte van doopgetuige(n)</span
              >
            </label>
            <input
              type="file"
              (change)="onFileSelected($event, 'godparents')"
              accept="image/*,.pdf"
              class="file-input file-input-bordered file-input-warning w-full"
            />
            @if(selectedGodparentsCertificate) {
            <label class="label">
              <span class="label-text-alt text-success"
                >Geselecteerd: {{ selectedGodparentsCertificate }}</span
              >
            </label>
            }
          </div>
        </div>
        }

        <!-- Step 5: Privacy & Additional Information -->
        @if(currentStep === 5) {
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-6">
            Privacyverklaring
          </h3>

          <div class="bg-amber-50 p-6 rounded-lg">
            <h4 class="font-bold text-lg text-gray-800 mb-3">
              Privacyverklaring Rooms-Katholieke Parochies en Algemene Regeling Bescherming Persoonsgegevens Parochies 2018.
            </h4>
            <p class="text-sm text-gray-700 mb-3">
              In verband met de Algemene Verordening Gegevensbescherming (AVG) is een Privacyverklaring van toepassing en zijn voornoemde regelingen opgesteld. De Privacyverklaring en de Algemene Regeling zijn beschikbaar op de website en kunnen worden gedownload.
            </p>
            <p class="text-sm text-gray-700 mb-3">
              Hieronder vindt u een aantal zaken (in verkorte, vereenvoudigde versies) die voor u van belang zijn en waarvoor wij uw toestemming (vooraf) vragen. Mocht u twijfelen over de uitleg in de verkorte versie, dan verwijzen wij u altijd naar de volledige Privacyverklaring en/of de Algemene Regeling op onze website.
            </p>
            <div class="mt-4 space-y-3">
              <div>
                <p class="font-semibold text-gray-800">Gegevens Algemeen</p>
              </div>
              <div>
                <p class="font-semibold text-gray-800">Akkoord</p>
                <p class="text-sm text-gray-700">
                  De aanvrager(s) gaat/gaan akkoord met de bepalingen van de Privacyverklaring.
                </p>
              </div>
              <div>
                <p class="font-semibold text-gray-800">Niet akkoord</p>
                <p class="text-sm text-gray-700">
                  Indien u niet akkoord gaat, kan de aanvraag niet worden verwerkt.
                </p>
              </div>
              <p class="text-sm text-gray-700">
                De gegevens die u verstrekt kunnen worden gebruikt voor parochieadministratie en zullen hiervoor digitaal of op papier (in registers) worden bewaard. U kunt een verzoek indienen om deze gegevens in te zien. Het verzoeken om verwijdering van deze gegevens is over het algemeen niet mogelijk omdat deze noodzakelijk zijn voor het goed functioneren van een parochiekerk. De procedure inschrijving en uitschrijving (2013) is van toepassing op verzoeken om uit de parochieregisters/administratie te worden verwijderd.
              </p>
              <p class="text-sm text-gray-700">
                Uw gegevens worden altijd vertrouwelijk behandeld en zullen nooit zonder uw toestemming worden verstrekt aan externe instellingen/instanties/derden.
              </p>
              <p class="text-sm text-gray-700 mb-3">
                Hieronder kunt u aangeven of u al dan niet akkoord gaat met bovengenoemde AVG en uw verzoek wordt verwerkt (ongeacht uw antwoord).
              </p>
            </div>
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Gaat u akkoord met het privacybeleid van onze parochie?
                <span class="text-red-600">*</span></span
              >
            </label>
            <div class="space-y-3">
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="privacyAgreement"
                  value="agree"
                  class="radio radio-warning"
                />
                <span class="label-text">Ja! Ik ga akkoord</span>
              </label>
              <label class="cursor-pointer flex items-center gap-2">
                <input
                  type="radio"
                  formControlName="privacyAgreement"
                  value="disagree"
                  class="radio radio-warning"
                />
                <span class="label-text">Nee! Ik ga niet akkoord</span>
              </label>
            </div>
            @if(communionForm.get('privacyAgreement')?.invalid &&
            communionForm.get('privacyAgreement')?.touched) {
            <label class="label">
              <span class="label-text-alt text-error"
                >Ga akkoord met het privacybeleid om door te gaan</span
              >
            </label>
            }
          </div>

          <div class="bg-gray-100 p-6 rounded-lg">
            <h4 class="font-bold text-lg text-gray-800 mb-2">Kosten</h4>
            <p class="text-gray-700">
              De kosten voor de voorbereiding op de Eerste Heilige Communie bedragen 75,00 euro per communicant.
            </p>
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text font-semibold text-gray-700"
                >Nieuw veld <span class="text-red-600">*</span></span
              >
            </label>
            <input
              type="text"
              formControlName="additionalField"
              placeholder="Voer aanvullende informatie in"
              class="input input-bordered w-full"
            />
          </div>
        </div>
        }

        <!-- Success Message -->
        @if(submitSuccess) {
        <div class="alert alert-success mb-6">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="stroke-current shrink-0 h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <span
            >Hartelijk dank voor uw Eerste Heilige Communie registratie! We nemen binnenkort contact met u op met voorbereidingsdetails.</span
          >
        </div>
        }

        <!-- Error Message -->
        @if(submitError) {
        <div class="alert alert-error mb-6">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="stroke-current shrink-0 h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <span
            >Er is een fout opgetreden bij het verzenden van uw verzoek. Probeer het opnieuw.</span
          >
        </div>
        }

        <!-- Navigation Buttons -->
        <div class="flex justify-between mt-8">
          @if(currentStep > 1) {
          <button
            type="button"
            class="btn btn-outline btn-warning"
            (click)="previousStep()"
          >
            Vorige
          </button>
          } @else {
          <div></div>
          } @if(currentStep < 5) {
          <button
            type="button"
            class="btn bg-amber-600 hover:bg-amber-700 text-white border-none"
            (click)="nextStep()"
          >
            Volgende
          </button>
          } @else {
          <button
            type="submit"
            class="btn bg-amber-600 hover:bg-amber-700 text-white border-none"
            [disabled]="communionForm.invalid || isSubmitting"
          >
            @if(isSubmitting) {
            <span class="loading loading-spinner"></span>
            Bezig met verzenden... } @else { Verzoek verzenden }
          </button>
          }
        </div>
      </form>
    </div>
  </div>
</section>
